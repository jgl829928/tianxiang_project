webpackJsonp([18],{"9eRm":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("Xxa5"),s=a.n(r),o=a("mvHQ"),l=a.n(o),i=a("exGp"),n=a.n(i),c=a("VsUZ"),u={name:"ConfigAdd",components:{Check:a("Q43l").a},data:function(){return{fileList:[],fileData:[],alldata:[],clear:!0,reqData:{serverId:"",version:"",comment:""},serveList:[{ID:"1"}],showInfo:!1,rules:{serverId:[{required:!0,message:"请选择serverId",trigger:"blur"}],version:[{required:!0,message:"请输入版本",trigger:"change"}]},dialogVisible:!1,errorMes:""}},computed:{token:function(){return this.$store.state.token}},methods:{upload_change:function(e,t){this.fileList=t},upload_remove:function(e,t){this.fileList=t},submitUpload:function(){var e=this;if(this.fileList.length<=0)return this.$message.error("请选择需要上传的文件"),!1;this.fileData=new FormData,this.$refs.upload_model.submit(),this.$http.post(c.b.upload,this.fileData).then(function(t){e.fileList=[],t&&1===t.Code?(e.$message({message:"恭喜你,文件上传成功,请检查",type:"success"}),e.alldata=[],e.clear=!e.clear,e.showInfo=!1):t.Data.error&&e.$notify({type:"error",duration:0,message:t.Data.error.join(",")})})},upload:function(e){this.fileData.append("file",e.file)},check:function(){var e=this;return n()(s.a.mark(function t(){var a;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.alldata=[],e.clear=!e.clear,t.next=4,e.$http.get(c.b.configCheck);case 4:(a=t.sent)&&1===a.Code?(e.showInfo=!0,e.alldata=JSON.parse(l()(a.Data.list))):a.Data.error&&(e.errorMes=a.Data.error,e.dialogVisible=!0);case 6:case"end":return t.stop()}},t,e)}))()},submitForm:function(e){this.$refs[e].validate(function(e){if(!e)return!1})}}},d={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"common_content config_add"},[a("div",{staticClass:"control_btn"},[a("el-upload",{ref:"upload_model",staticClass:"upload_content",attrs:{multiple:"","file-list":e.fileList,"show-file-list":!0,"on-change":e.upload_change,"on-remove":e.upload_remove,"http-request":e.upload,action:e.$http.defaults.baseURL+"/subaction/config/upload","auto-upload":!1}},[a("el-button",{attrs:{slot:"trigger",size:"small",type:"success",plain:""},slot:"trigger"},[e._v("选择文件")]),e._v(" "),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"small",type:"primary"},on:{click:e.submitUpload}},[e._v("upload")])],1)],1),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.check}},[e._v("check")]),e._v(" "),e.showInfo?a("div",{staticClass:"checkInfo"},[a("Check",{attrs:{alldata:e.alldata,clear:e.clear}}),e._v(" "),a("div",[a("el-form",{ref:"reqData_form",staticClass:"cfgadd_form",attrs:{"label-width":"102px",inline:!0,"label-position":"right",model:e.reqData,rules:e.rules}},[a("el-row",[a("el-col",{attrs:{span:8,xs:24}},[a("el-form-item",{attrs:{label:"Server ID",prop:"serverId","min-width":"120"}},[a("el-select",{attrs:{clearable:"",placeholder:"Server ID"},model:{value:e.reqData.serverId,callback:function(t){e.$set(e.reqData,"serverId",t)},expression:"reqData.serverId"}},e._l(e.serveList,function(e,t){return a("el-option",{key:t,attrs:{label:e.ID,value:e.ID}})}),1)],1)],1),e._v(" "),a("el-col",{attrs:{span:6,xs:24}},[a("el-form-item",{attrs:{label:"Version",prop:"version"}},[a("el-input",{model:{value:e.reqData.version,callback:function(t){e.$set(e.reqData,"version",t)},expression:"reqData.version"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:10,xs:24}},[a("el-form-item",{attrs:{label:"Comment",prop:"comment","min-width":"120"}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.reqData.comment,callback:function(t){e.$set(e.reqData,"comment",t)},expression:"reqData.comment"}})],1)],1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("reqData_form")}}},[e._v("submit")])],1)],1)],1)],1):e._e(),e._v(" "),a("el-dialog",{attrs:{title:"错误提示",visible:e.dialogVisible,width:"80%","close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1,center:""},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("span",[e._v(e._s(e.errorMes))]),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("确 定")])],1)])],1)},staticRenderFns:[]};var f=a("VU/8")(u,d,!1,function(e){a("Izi/"),a("blbZ")},"data-v-43adf22d",null);t.default=f.exports},"Izi/":function(e,t){},blbZ:function(e,t){}});
//# sourceMappingURL=18.97e4c6a50b713db7ba05.js.map