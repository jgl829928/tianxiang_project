webpackJsonp([17],{Jg5d:function(e,t){},rSVN:function(e,t){},sZNU:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("mvHQ"),r=n.n(a),i=n("BO1k"),l=n.n(i),o=n("Xxa5"),s=n.n(o),c=n("exGp"),u=n.n(c),p=n("VsUZ"),v=n("TIfe"),m={name:"Actives",data:function(){return{typeSelect:{},timeType:"1",tableData:[]}},mounted:function(){this.getData()},methods:{getData:function(){var e=this;return u()(s.a.mark(function t(){var n;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.timeType=e.$route.params.timeType?e.$route.params.timeType:"1",t.next=3,e.$http.get(p.b.active);case 3:(n=t.sent)&&1===n.Code&&(e.typeSelect=n.Data),e.getTbaleData();case 6:case"end":return t.stop()}},t,e)}))()},handleClick:function(e){this.getTbaleData()},getTbaleData:function(){var e=this;return u()(s.a.mark(function t(){var n,a,r,i;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get(p.b.activeInfo+"?referencetype="+e.timeType);case 2:if((n=t.sent)&&1===n.Code)for(r in e.tableData=[],a=n.Data.activitygroups)i=a[r],e.tableData.push({Comment:i.Comment,GroupID:r,activities:i.Activities,ServerIDList:i.Activities.length>0?i.Activities[0].ServerInfoList:[]});case 4:case"end":return t.stop()}},t,e)}))()},remainingTime:function(e,t){return Object(v.m)(e,t)},reverseType:function(e){var t=!0,n=!1,a=void 0;try{for(var r,i=l()(this.typeSelect.activityTypeSelect);!(t=(r=i.next()).done);t=!0){var o=r.value;if(o.Type==e)return o.Des}}catch(e){n=!0,a=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw a}}return e},handleEdit:function(e){var t=JSON.parse(r()(e));t.activities=r()(t.activities),t.ServerIDList=r()(t.ServerIDList),t.timeType=this.timeType,this.$router.push({path:"/activities/edit",query:t})},handleDelete:function(e){var t=this;e.ServerInfoList&&e.ServerInfoList.length>0?this.$message("请先编辑服务器"):this.$confirm("此操作将永久删除该活动, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var n=t;Object(v.a)(function(){n.deleteSubmit(e)},500)()})},deleteSubmit:function(e){var t=this;return u()(s.a.mark(function n(){var a,r;return s.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return a={GroupID:Number(e.GroupID)},n.next=3,t.$http.post(p.b.activeDelete,a);case 3:(r=n.sent)&&1===r.Code&&(t.$message({type:"success",message:"删除成功!"}),t.getTbaleData());case 5:case"end":return n.stop()}},n,t)}))()},formatUtc:function(e){return Object(v.j)(e)}}},f={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"common_content activity_content"},[n("el-tabs",{attrs:{type:"border-card"},on:{"tab-click":e.handleClick},model:{value:e.timeType,callback:function(t){e.timeType=t},expression:"timeType"}},e._l(e.typeSelect.referenceTypeSelect,function(e,t){return n("el-tab-pane",{key:t,attrs:{label:e.Des,name:e.Type+""}})}),1),e._v(" "),n("div",{staticClass:"activity_table"},[n("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,stripe:"","show-overflow-tooltip":!0,"max-height":"780"}},[n("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-table",{staticClass:"activities_table",staticStyle:{width:"100%"},attrs:{data:t.row.activities,border:"","max-height":"280"}},[n("el-table-column",{attrs:{align:"center",prop:"Index",label:"Index"}}),e._v(" "),n("el-table-column",{attrs:{align:"center",prop:"ID",label:"ID"}}),e._v(" "),n("el-table-column",{attrs:{align:"center",prop:"Ahead",label:"Ahead"}}),e._v(" "),n("el-table-column",{attrs:{align:"center",prop:"Delay",label:"Delay"}}),e._v(" "),n("el-table-column",{attrs:{align:"center",prop:"ActivityType",label:"ActivityType"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(e.reverseType(t.row.ActivityType)))])]}}],null,!0)}),e._v(" "),n("el-table-column",{attrs:{align:"center",prop:"Time",label:"Time"},scopedSlots:e._u([{key:"default",fn:function(t){return[1==e.timeType?n("span",[e._v("\n                                    "+e._s(e.formatUtc(1e3*t.row.TimeArg1))+"-"+e._s(e.formatUtc(1e3*t.row.TimeArg2))+"\n                                ")]):n("span",[e._v(e._s(t.row.TimeArg1)+"-"+e._s(t.row.TimeArg2))])]}}],null,!0)}),e._v(" "),1==e.timeType?n("el-table-column",{attrs:{align:"center",prop:"State",label:"State"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",{class:["进行中"==e.remainingTime(t.row.TimeArg1,t.row.TimeArg2)?"green_font":"red_font"]},[e._v("\n                                    "+e._s(e.remainingTime(t.row.TimeArg1,t.row.TimeArg2)))])]}}],null,!0)}):e._e()],1)]}}])}),e._v(" "),n("el-table-column",{attrs:{align:"center",prop:"GroupID",label:"GroupID"}}),e._v(" "),n("el-table-column",{attrs:{align:"center",prop:"ServerIDList",label:"ServerIDList"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.ServerIDList&&t.row.ServerIDList.length>0?n("span",[e._v(e._s(t.row.ServerIDList.join(",")))]):n("span",[e._v("-")])]}}])}),e._v(" "),n("el-table-column",{attrs:{align:"center",prop:"Comment",label:"Comment"}}),e._v(" "),n("el-table-column",{attrs:{align:"center",label:"Options",width:"300"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("div",[n("el-button",{attrs:{icon:"el-icon-edit",type:"primary",size:"small"},on:{click:function(n){return e.handleEdit(t.row)}}},[e._v("\n                            edit")]),e._v(" "),n("el-button",{attrs:{type:"danger",size:"small",plain:""},on:{click:function(n){return e.handleDelete(t.row)}}},[e._v("delete\n                        ")])],1)]}}])})],1)],1)],1)},staticRenderFns:[]};var d=n("VU/8")(m,f,!1,function(e){n("rSVN"),n("Jg5d")},"data-v-551ea87a",null);t.default=d.exports}});
//# sourceMappingURL=17.e6f6fabdddb828e74d5d.js.map