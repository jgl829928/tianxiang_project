webpackJsonp([15],{"3W8Q":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("Xxa5"),r=a.n(s),o=a("mvHQ"),i=a.n(o),l=a("exGp"),n=a.n(l),c=a("VsUZ"),u=a("TIfe"),d={name:"ConfigAdd",components:{Check:a("Q43l").a},data:function(){return{fileList:[],fileData:[],alldata:[],clear:!0,reqData:{serverId:"",version:"",comment:""},serveList:[{ID:"1"},{ID:"2"}],showInfo:!1,rules:{serverId:[{required:!0,message:"请选择serverId",trigger:"blur"}],version:[{required:!0,message:"请输入版本",trigger:"change"}]},dialogVisible:!1,errorMes:""}},computed:{token:function(){return this.$store.state.token}},methods:{upload_change:function(e,t){this.fileList=t},upload_remove:function(e,t){this.fileList=t},submitUpload:Object(u.a)(function(){var e=this;if(this.fileList.length<=0)return this.$message.error("请选择需要上传的文件"),!1;this.fileData=new FormData,this.$refs.upload_model.submit(),this.$http.post(c.b.upload,this.fileData).then(function(t){e.fileList=[],t&&1===t.Code?(e.$message({message:"恭喜你,文件上传成功,请检查",type:"success"}),e.alldata=[],e.clear=!e.clear,e.showInfo=!1):-504==t.Code&&(e.errorMes=t.Data.error,e.dialogVisible=!0,e.showInfo=!1)})},500),upload:function(e){this.fileData.append("file",e.file)},check:Object(u.a)(n()(r.a.mark(function e(){var t;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.alldata=[],this.clear=!this.clear,e.next=4,this.$http.get(c.b.configCheck);case 4:(t=e.sent)&&1===t.Code?(this.showInfo=!0,t.Data&&(this.alldata=JSON.parse(i()(t.Data.list)))):-505===t.Code&&(this.errorMes=t.Data.error.join("<br/>"),this.dialogVisible=!0);case 6:case"end":return e.stop()}},e,this)})),500),submitForm:Object(u.a)(function(e){this.$refs[e].validate(function(e){if(!e)return!1})},500)}},f={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"common_content config_content"},[a("div",{staticClass:"control_btn"},[a("el-upload",{ref:"upload_model",staticClass:"upload_content",attrs:{multiple:"","file-list":e.fileList,"show-file-list":!0,"on-change":e.upload_change,"on-remove":e.upload_remove,"http-request":e.upload,action:e.$http.defaults.baseURL+"/subaction/config/upload","auto-upload":!1}},[a("el-button",{attrs:{slot:"trigger",size:"small",type:"success",plain:""},slot:"trigger"},[e._v("选择文件")]),e._v(" "),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"small",type:"primary"},on:{click:e.submitUpload}},[e._v("upload")])],1)],1),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.check}},[e._v("check")]),e._v(" "),e.showInfo?a("div",{staticClass:"checkInfo"},[a("Check",{attrs:{alldata:e.alldata,clear:e.clear}}),e._v(" "),a("div",[a("el-form",{ref:"reqData_form",staticClass:"cfgadd_form",attrs:{"label-width":"102px",inline:!0,"label-position":"right",model:e.reqData,rules:e.rules}},[a("el-row",[a("el-col",{attrs:{span:8,xs:24}},[a("el-form-item",{attrs:{label:"Server ID",prop:"serverId","min-width":"120"}},[a("el-select",{attrs:{clearable:"",multiple:"",placeholder:"Server ID"},model:{value:e.reqData.serverId,callback:function(t){e.$set(e.reqData,"serverId",t)},expression:"reqData.serverId"}},e._l(e.serveList,function(e,t){return a("el-option",{key:t,attrs:{label:e.ID,value:e.ID}})}),1)],1)],1),e._v(" "),a("el-col",{attrs:{span:6,xs:24}},[a("el-form-item",{attrs:{label:"Version",prop:"version"}},[a("el-input",{model:{value:e.reqData.version,callback:function(t){e.$set(e.reqData,"version",t)},expression:"reqData.version"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:10,xs:24}},[a("el-form-item",{attrs:{label:"Comment",prop:"comment","min-width":"120"}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.reqData.comment,callback:function(t){e.$set(e.reqData,"comment",t)},expression:"reqData.comment"}})],1)],1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("reqData_form")}}},[e._v("submit")])],1)],1)],1)],1):e._e(),e._v(" "),a("el-dialog",{attrs:{title:"错误提示",visible:e.dialogVisible,width:"80%","close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1,center:""},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("div",{domProps:{innerHTML:e._s(e.errorMes)}},[e._v(e._s(e.errorMes))]),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("确 定")])],1)])],1)},staticRenderFns:[]};var p=a("VU/8")(d,f,!1,function(e){a("z1tg"),a("JZWh")},"data-v-f459c292",null);t.default=p.exports},JZWh:function(e,t){},z1tg:function(e,t){}});
//# sourceMappingURL=15.da4fd16d4bf8c5e89d14.js.map