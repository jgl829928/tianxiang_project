webpackJsonp([11],{"4IFq":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("//Fk"),s=a.n(n),r=a("Xxa5"),i=a.n(r),l=a("exGp"),o=a.n(l),c=a("VsUZ"),u=a("TIfe"),d={name:"Server",data:function(){return{tableData:[],listID:[],timeInterval:"",reuqestList:[],resList:[],stateData:[],updateTime:5,isOpen:!1}},created:function(){this.getData()},beforeRouteLeave:function(t,e,a){clearInterval(this.timeInterval),a()},methods:{getData:function(){var t=this;return o()(i.a.mark(function e(){var a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$http.get(c.b.server);case 2:(a=e.sent)&&1===a.Code&&(t.tableData=a.Data.status||[]),t.tableData.map(function(t){t.status="",t.time=60}),t.getStateData(),t.timeInterval=setInterval(t.getStateData,1e3*t.updateTime);case 7:case"end":return e.stop()}},e,t)}))()},getStateData:function(){var t=this;return o()(i.a.mark(function e(){var a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(a=0;a<t.tableData.length;a++)t.reuqestList.push(t.$http.get(c.b.serverStatus+"?serverid="+t.tableData[a].ID));return e.next=3,s.a.all(t.reuqestList);case 3:t.resList=e.sent,t.stateData=[],t.resList.map(function(e){e.Data&&e.Data.status?t.stateData.push(e.Data.status[0]):t.stateData.push({})}),t.dealData(t.stateData),t.reuqestList=[];case 8:case"end":return e.stop()}},e,t)}))()},dealData:function(t){var e=this.tableData;t.forEach(function(t,a){t.Running=Object(u.b)(t.Running),0===t.Status&&(e[a].status="start"),1===t.Status&&(e[a].status="close"),2===t.Status&&(e[a].status="closing")})},handleEdit:function(t,e){this.$router.push({path:"server/edit",query:{id:e.ID}})},changestatus:function(t,e){var a=this;"start"==e.status&&this.$confirm("您确定要开启服务器 ID="+e.ID+" 服务器名="+e.Name+"?","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(){a.startServer(t,e)}),"close"==e.status&&this.$confirm("您确定要关闭服务器 ID="+e.ID+" 服务器名="+e.Name+"?","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(){a.closeServer(t,e)})},startServer:function(t,e){var a=this;this.$http.get(c.b.start+"?serverid="+e.ID).then(function(t){if(!t||1!==t.Code)return a.$message.error("服务器打开失败，请重试"),!1;a.getStateData(),setTimeout(function(){a.$message({message:"服务器正在打开,请稍等...",type:"success"})},3e3)})},closeServer:function(t,e){var a=this;this.$http.get(c.b.close+"?serverid="+e.ID).then(function(n){if(!n||1!==n.Code)return a.$message.error("服务器关闭失败，请重试"),!1;a.$message({message:"服务器正在关闭",type:"success"}),e.time=60;var s=setInterval(function(){e.time<=0?(clearInterval(s),a.getStateData()):(e.time--,a.$set(e,"time",e.time),a.$set(a.tableData,t,e))},1e3)})}}},p={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"common_content"},[a("div",{staticClass:"common_radio"},[a("span",[t._v("Refresh Interval")]),t._v(" "),a("el-radio-group",{model:{value:t.updateTime,callback:function(e){t.updateTime=e},expression:"updateTime"}},[a("el-radio",{attrs:{label:5}},[t._v("5s")]),t._v(" "),a("el-radio",{attrs:{label:10}},[t._v("10s")]),t._v(" "),a("el-radio",{attrs:{label:15}},[t._v("15s")])],1)],1),t._v(" "),a("div",{class:t.isOpen?"open":"close"},[a("el-button",{attrs:{icon:t.isOpen?"el-icon-arrow-right":"el-icon-arrow-left",circle:"",type:"info"},on:{click:function(e){t.isOpen=!t.isOpen}}})],1),t._v(" "),a("el-table",{staticClass:"content_table",staticStyle:{width:"100%"},attrs:{data:t.tableData,border:"",stripe:"","show-overflow-tooltip":!0}},[a("el-table-column",{attrs:{align:"center",prop:"ID",label:"ID",width:"150"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"Type",label:"Type","min-width":"100"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"Name",label:"Name","min-width":"100"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"Ping",label:"Ping","min-width":"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.stateData[e.$index]?a("span",[t._v("\n          "+t._s(t.stateData[e.$index].Ping)+"\n        ")]):t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"Running",label:"Running","min-width":"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.stateData[e.$index]?a("span",[t._v("\n          "+t._s(t.stateData[e.$index].Running)+"\n        ")]):t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"CPU",label:"CPU","min-width":"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.stateData[e.$index]?a("span",[t._v("\n          "+t._s(t.stateData[e.$index].CPUProfile)+"\n        ")]):t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"RAM",label:"RAM","min-width":"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.stateData[e.$index]?a("span",[t._v("\n          "+t._s(t.stateData[e.$index].RAMProfile)+"\n        ")]):t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"DISK",label:"DISK","min-width":"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.stateData[e.$index]?a("span",[t._v("\n          "+t._s(t.stateData[e.$index].DISKProfile)+"\n        ")]):t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"ClientOnline",label:"ClientOnline","min-width":"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.stateData[e.$index]?a("span",[t._v("\n          "+t._s(t.stateData[e.$index].OnlineInfo)+"\n        ")]):t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"Status",label:"Status","min-width":"120"},scopedSlots:t._u([{key:"default",fn:function(e){return t.stateData[e.$index]?[0==t.stateData[e.$index].Status?a("span",[t._v("\n          close\n        ")]):1==t.stateData[e.$index].Status?a("span",[t._v("\n          open\n        ")]):2==t.stateData[e.$index].Status?a("span",[t._v("\n          closing\n        ")]):t._e()]:void 0}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"Area",label:"Area","min-width":"120"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"ConnectServers",label:"ConnectServers","min-width":"210"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.stateData[e.$index]?a("div",t._l(t.stateData[e.$index].ConnectServers,function(e,n){return a("p",{key:n},[t._v(t._s(e.Type)+" :\n            "+t._s(e.Connected))])})):t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"ExterIP",label:"ExterIP","min-width":"120"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"InnerIP",label:"InnerIP","min-width":"120"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"ClientPort",label:"ClientPort","min-width":"120"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"CommandPort",label:"CommandPort","min-width":"120"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"WatchPort",label:"WatchPort","min-width":"120"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"WatchURL",label:"WatchURL","min-width":"120"}}),t._v(" "),t.isOpen?a("el-table-column",{attrs:{align:"center",fixed:"right",label:"options","min-width":"250"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{icon:"el-icon-edit",type:"primary",size:"small"},on:{click:function(a){t.handleEdit(e.$index,e.row)}}},[t._v("edit")]),t._v(" "),"gameserver"==e.row.Type?a("el-button",{attrs:{size:"small",disabled:e.row.time<60&&e.row.time>0||"closing"==e.row.status},on:{click:function(a){t.changestatus(e.$index,e.row)}}},[e.row.time<60&&e.row.time>0?a("span",[t._v(t._s(e.row.time))]):a("span",[t._v(t._s(e.row.status))])]):t._e()]}}])}):t._e()],1)],1)},staticRenderFns:[]};var m=a("VU/8")(d,p,!1,function(t){a("izLN")},"data-v-33205b37",null);e.default=m.exports},izLN:function(t,e){}});
//# sourceMappingURL=11.82675e8cd5faf55f5bb7.js.map