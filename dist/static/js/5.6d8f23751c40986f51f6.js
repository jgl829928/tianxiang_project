webpackJsonp([5],{TKD4:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("mvHQ"),n=a.n(r),l=a("Xxa5"),s=a.n(l),i=a("exGp"),o=a.n(i),c=a("VsUZ"),u=a("TIfe"),p={name:"Income",data:function(){return{isSeverIdte:!0,serverCheckAll:!1,isCountryIdte:!0,countryCheckAll:!1,serveList:[],allLang:[],reqData:{StartUnix:"",EndUnix:"",ZoneList:[],PlatformList:"",CountryList:[],time:[]},tableData:[],decimalNum:3,sumItem:{},loading:!1}},mounted:function(){var e=this;this.getData(),Object(u.c)().then(function(t){e.allLang=t})},methods:{getData:function(){var e=this;return o()(s.a.mark(function t(){var a;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get(c.b.income);case 2:(a=t.sent)&&1===a.Code&&(e.serveList=a.Data.incomelist);case 4:case"end":return t.stop()}},t,e)}))()},serverChange:function(e){this.reqData.ZoneList=e?this.serveList:[],this.isSeverIdte=!1},countryChange:function(e){this.reqData.CountryList=e?this.allLang:[],this.isCountryIdte=!1},search:Object(u.a)(function(){this.loading=!0;var e=JSON.parse(n()(this.reqData)),t=this.reqData.time;e.StartUnix=t&&t.length>0?Date.parse(t[0])/1e3:"";var a=t&&t.length>0?Date.parse(t[1])-Date.parse(t[0]):0;e.Day=Math.ceil(a/864e5),delete e.time,delete e.EndUnix,e.CountryList=e.CountryList.map(function(e){return"'"+e+"'"}).join(","),e.ZoneList=e.ZoneList.join(","),this.requestData(e)},500),requestData:function(e){var t=this;return o()(s.a.mark(function a(){var r,n;return s.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t.$http.post(c.b.incomeInfo,e);case 2:if((r=a.sent)&&1===r.Code&&r.Data.income){a.next=6;break}return t.tableData=[],a.abrupt("return");case 6:t.loading=!1,n=r.Data.income.sort(function(e,t){return t.Unix-e.Unix}),t.tableData=t.dealTableData(n);case 9:case"end":return a.stop()}},a,t)}))()},dealTableData:function(e){var t=this;return!(!e||e.length<=0)&&(e.map(function(e){""==e.QueryZoneList&&(e.QueryZoneList="全服"),""==e.QueryPlatformList&&(e.QueryPlatformList="ios，andriod"),e.arpu=Object(u.g)(e.Amount,e.ActiveUserCount).toFixed(t.decimalNum),e.payRate=(100*Object(u.g)(e.ChargeUserCount,e.ActiveUserCount)).toFixed(t.decimalNum)+"%",e.arppu=Object(u.g)(e.Amount,e.ChargeUserCount).toFixed(t.decimalNum),e.date=Object(u.j)(1e3*e.Unix,!1).split(" ")[0]}),e)},getSummaries:function(e){var t=this,a=e.columns,r=e.data;if(!r||r.length<=0)return[];var n=[],l={};return a.forEach(function(e,a){if("arpu"!==e.property&&"arppu"!==e.property&&"payRate"!==e.property)if(0!==a){var s=r.map(function(t){return Number(t[e.property])});s.every(function(e){return isNaN(e)})?n[a]="N/A":(n[a]=s.reduce(function(e,t){var a=Number(t);return isNaN(a)?e:Object(u.b)(e,t)},0),n[a]=n[a].toFixed(t.decimalNum),l[e.property]=n[a])}else n[a]="合计"}),a.forEach(function(e,a){switch(e.property){case"arpu":n[a]=Object(u.g)(l.Amount,l.ActiveUserCount).toFixed(t.decimalNum);break;case"payRate":n[a]=(100*Object(u.g)(l.ChargeUserCount,l.ActiveUserCount)).toFixed(t.decimalNum)+"%";break;case"arppu":n[a]=Object(u.g)(l.Amount,l.ChargeUserCount).toFixed(t.decimalNum)}l[e.property]=n[a]}),this.sumItem=l,n},resetForm:function(e){this.$refs[e].resetFields()},download:Object(u.a)(function(){var e=JSON.parse(n()(this.tableData));e.push(this.sumItem),Object(u.l)(["区服","平台","日期","收入","付费用户数","用户付费率","新增用户数","DAU","当日注册付费人数","当日注册付费额度","ARPU","ARPPU"],["QueryZoneList","QueryPlatformList","date","Amount","ChargeUserCount","payRate","NewUserCount","ActiveUserCount","RegisterChargeCount","RegisterChargeAmount","arpu","arppu"],e,"营收数据xls")},500)}},d={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"operation_content"},[a("el-form",{ref:"reqData",staticClass:"demo-ruleForm",attrs:{model:e.reqData,"label-width":"102px",inline:!0,"label-position":"right"}},[a("el-row",[a("el-col",{attrs:{span:8,xs:24}},[a("el-form-item",{attrs:{label:"日期",prop:"time"}},[a("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始时间","default-time":["00:00:00","23:59:59"],"end-placeholder":"结束时间","value-format":"yyyy-MM-ddTHH:mm:ssZ"},model:{value:e.reqData.time,callback:function(t){e.$set(e.reqData,"time",t)},expression:"reqData.time"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:8,xs:24}},[a("el-form-item",{attrs:{label:"平台",prop:"PlatformList"}},[a("el-select",{attrs:{clearable:"",placeholder:"Platform"},model:{value:e.reqData.PlatformList,callback:function(t){e.$set(e.reqData,"PlatformList",t)},expression:"reqData.PlatformList"}},[a("el-option",{attrs:{label:"ios",value:"ios"}}),e._v(" "),a("el-option",{attrs:{label:"android",value:"android"}})],1)],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:24,xs:24}},[a("el-form-item",{attrs:{label:"区服",prop:"ZoneList"}},[a("div",{staticClass:"checkbox"},[a("el-scrollbar",{staticStyle:{height:"100%"}},[a("el-checkbox",{attrs:{indeterminate:e.isSeverIdte},on:{change:e.serverChange},model:{value:e.serverCheckAll,callback:function(t){e.serverCheckAll=t},expression:"serverCheckAll"}},[e._v("全选")]),e._v(" "),a("el-checkbox-group",{model:{value:e.reqData.ZoneList,callback:function(t){e.$set(e.reqData,"ZoneList",t)},expression:"reqData.ZoneList"}},e._l(e.serveList,function(e,t){return a("el-checkbox",{key:t,attrs:{label:e,value:e}})}),1)],1)],1)])],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:24,xs:24}},[a("el-form-item",{attrs:{label:"国家",prop:"CountryList"}},[a("div",{staticClass:"checkbox"},[a("el-scrollbar",{staticStyle:{height:"100%"}},[a("el-checkbox",{attrs:{indeterminate:e.isCountryIdte},on:{change:e.countryChange},model:{value:e.countryCheckAll,callback:function(t){e.countryCheckAll=t},expression:"countryCheckAll"}},[e._v("全选")]),e._v(" "),a("el-checkbox-group",{model:{value:e.reqData.CountryList,callback:function(t){e.$set(e.reqData,"CountryList",t)},expression:"reqData.CountryList"}},e._l(e.allLang,function(t,r){return a("el-checkbox",{key:r,attrs:{label:t}},[e._v(e._s(t)+"\n                                ")])}),1)],1)],1)])],1)],1)],1),e._v(" "),a("div",{staticClass:"operate_btn"},[a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.search}},[e._v("search")]),e._v(" "),a("el-button",{attrs:{type:"plain",icon:"el-icon-refresh"},on:{click:function(t){return e.resetForm("reqData")}}},[e._v("reset")])],1),e._v(" "),a("div",{staticClass:"download_btn"},[a("el-button",{attrs:{type:"success",icon:"el-icon-download",plain:"",disabled:e.tableData.length<=0},on:{click:e.download}},[e._v("\n            download")])],1),e._v(" "),a("div",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"","show-summary":"",stripe:"","show-overflow-tooltip":!0,"summary-method":e.getSummaries,"max-height":"600"}},[a("el-table-column",{attrs:{prop:"QueryZoneList",label:"区服"}}),e._v(" "),a("el-table-column",{attrs:{prop:"QueryPlatformList",label:"平台"}}),e._v(" "),a("el-table-column",{attrs:{prop:"date",label:"日期"}}),e._v(" "),a("el-table-column",{attrs:{prop:"Amount",label:"收入"}}),e._v(" "),a("el-table-column",{attrs:{prop:"ChargeUserCount",label:"付费用户数"}}),e._v(" "),a("el-table-column",{attrs:{prop:"payRate",label:"用户付费率"}}),e._v(" "),a("el-table-column",{attrs:{prop:"NewUserCount",label:"新增用户数"}}),e._v(" "),a("el-table-column",{attrs:{prop:"ActiveUserCount",label:"DAU"}}),e._v(" "),a("el-table-column",{attrs:{prop:"RegisterChargeCount",label:"当日注册付费人数"}}),e._v(" "),a("el-table-column",{attrs:{prop:"RegisterChargeAmount",label:"当日注册付费额度"}}),e._v(" "),a("el-table-column",{attrs:{prop:"arpu",label:"ARPU"}}),e._v(" "),a("el-table-column",{attrs:{prop:"arppu",label:"ARPPU"}})],1)],1)],1)},staticRenderFns:[]},h=a("VU/8")(p,d,!1,null,null,null).exports,m=a("BO1k"),v=a.n(m),b={name:"Online",data:function(){return{isSeverIdte:!0,serverCheckAll:!1,isCountryIdte:!0,countryCheckAll:!1,isLTVIdte:!0,ltvCheckAll:!1,isRemainIdte:!0,remainCheckAll:!1,serveList:[],allLang:[],ltvList:[1,2,3,4,5,6,7,14,15,21,30,45,60,75,90,105,120,250,180,210,270,300,330,360,390,420,450,480,510,540,570,600,630,660,690,720],remainList:[1,2,3,4,5,6,7,14,15,21,30,45,60,75,90,105,120,250,180,210,270,300,330,360,390,420,450,480,510,540,570,600,630,660,690,720],reqData:{StartUnix:"",ZoneList:[],PlatformList:"",CountryList:[],time:[],LtvList:[],KeepDayList:[],LoserList:[1,3,7],BackUserList:[3,7]},tableData:[],initHeads:["区服","平台","日期","PCU","PCU-Time","ACU","活跃账号平均在线时长(分)","回流用户数","日新手引导完成数"],tableHeads:[],initProps:["QueryZoneList","QueryPlatformList","Unix","PCU","PCUUnix","ACUCount","AvgOnlineCount","BackUser","NewPlayer"],tableProps:[],decimalNum:3,loading:!1}},mounted:function(){var e=this;this.getData(),Object(u.c)().then(function(t){e.allLang=t})},methods:{getData:function(){var e=this;return o()(s.a.mark(function t(){var a;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get(c.b.income);case 2:(a=t.sent)&&1===a.Code&&(e.serveList=a.Data.incomelist);case 4:case"end":return t.stop()}},t,e)}))()},serverChange:function(e){this.reqData.ZoneList=e?this.serveList:[],this.isSeverIdte=!1},countryChange:function(e){this.reqData.CountryList=e?this.allLang:[],this.isCountryIdte=!1},ltvChange:function(e){this.reqData.LtvList=e?this.ltvList:[],this.isLTVIdte=!1},remainChange:function(e){this.reqData.KeepDayList=e?this.remainList:[],this.isRemainIdte=!1},search:Object(u.a)(function(){this.loading=!0;var e=JSON.parse(n()(this.reqData)),t=this.reqData.time;e.StartUnix=t&&t.length>0?Date.parse(t[0])/1e3:"";var a=t&&t.length>0?Date.parse(t[1])-Date.parse(t[0]):0;e.Day=Math.ceil(a/864e5),delete e.time,e.CountryList=e.CountryList.map(function(e){return"'"+e+"'"}).join(","),e.ZoneList=e.ZoneList.join(","),this.requestData(e)},500),requestData:function(e){var t=this;return o()(s.a.mark(function a(){var r,n;return s.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t.$http.post(c.b.incomeOnline,e);case 2:if((r=a.sent)&&1===r.Code&&r.Data.online){a.next=6;break}return t.tableData=[],a.abrupt("return");case 6:t.loading=!1,n=r.Data.online.sort(function(e,t){return t.Unix-e.Unix}),t.addHeadProps(n),t.tableData=t.dealTableData(n);case 10:case"end":return a.stop()}},a,t)}))()},addHeadProps:function(e){if(!e||e.length<=0)return!1;var t=e[0];this.tableHeads=[],this.tableProps=[];var a=JSON.parse(n()(this.initHeads)),r=JSON.parse(n()(this.initProps));if(t.QueryLoserList&&t.QueryLoserList.length>0){var l=!0,s=!1,i=void 0;try{for(var o,c=v()(t.QueryLoserList);!(l=(o=c.next()).done);l=!0){var u=o.value;a.push("("+u+"日)流失率"),r.push("Lose"+u)}}catch(e){s=!0,i=e}finally{try{!l&&c.return&&c.return()}finally{if(s)throw i}}}if(t.QueryKeepList&&t.QueryKeepList.length>0){var p=!0,d=!1,h=void 0;try{for(var m,b=v()(t.QueryKeepList);!(p=(m=b.next()).done);p=!0){var f=m.value;a.push("留存"+f),r.push("Keep"+f)}}catch(e){d=!0,h=e}finally{try{!p&&b.return&&b.return()}finally{if(d)throw h}}}if(t.QueryLtvList&&t.QueryLtvList.length>0){var L=!0,y=!1,C=void 0;try{for(var g,x=v()(t.QueryLtvList);!(L=(g=x.next()).done);L=!0){var D=g.value;a.push("LTV"+D),r.push("Ltv"+D)}}catch(e){y=!0,C=e}finally{try{!L&&x.return&&x.return()}finally{if(y)throw C}}}this.tableHeads=a,this.tableProps=r},dealTableData:function(e){var t=this;return!(!e||e.length<=0)&&(e.map(function(e,a){""==e.QueryZoneList&&(e.QueryZoneList="全服"),""==e.QueryPlatformList&&(e.QueryPlatformList="ios，andriod"),e.PCUUnix=Object(u.j)(1e3*e.PCUUnix,!1).split(" ")[1],e.Unix=Object(u.j)(1e3*e.Unix,!1).split(" ")[0],e.BackUser=t.getBackUser(e.BackUserList),e.NewPlayer=0,e.NewPlayerNodeList&&e.NewPlayerNodeList.length>=0&&e.NewPlayerNodeList.map(function(t){10004===t.NodeID&&(e.NewPlayer=t.Count)}),e.KeepList&&e.KeepList.length>=0&&e.KeepList.map(function(a){e["Keep"+a.Day]=(100*Object(u.g)(a.KeepUserCount,a.NewUserCount)).toFixed(t.decimalNum)+"%"}),e.LtvList&&e.LtvList.length>=0&&e.LtvList.map(function(a){e["Ltv"+a.Day]=Object(u.g)(a.Amount,a.NewUserCount).toFixed(t.decimalNum)}),e.LoserList&&e.LoserList.length>=0&&e.LoserList.map(function(a){e["Lose"+a.Day]=(100*Object(u.g)(a.LoseUserCount,a.ActiveUserCount)).toFixed(t.decimalNum)+"%"})}),e)},getBackUser:function(e){if(e&&!(e.length<=0)){for(var t=0,a=0;a<e.length;a++)t=Object(u.b)(t,e[a].BackUser);return t}},resetForm:function(e){this.$refs[e].resetFields()},download:Object(u.a)(function(){var e=JSON.parse(n()(this.tableData));Object(u.l)(this.tableHeads,this.tableProps,e,"在线数据xls")},500)}},f={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"operation_content"},[a("el-form",{ref:"reqData",staticClass:"demo-ruleForm",attrs:{model:e.reqData,"label-width":"102px",inline:!0,"label-position":"right"}},[a("el-row",[a("el-col",{attrs:{span:8,xs:24}},[a("el-form-item",{attrs:{label:"日期",prop:"time"}},[a("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始时间","default-time":["00:00:00","23:59:59"],"end-placeholder":"结束时间","value-format":"yyyy-MM-ddTHH:mm:ssZ"},model:{value:e.reqData.time,callback:function(t){e.$set(e.reqData,"time",t)},expression:"reqData.time"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:8,xs:24}},[a("el-form-item",{attrs:{label:"平台",prop:"PlatformList"}},[a("el-select",{attrs:{clearable:"",placeholder:"Platform"},model:{value:e.reqData.PlatformList,callback:function(t){e.$set(e.reqData,"PlatformList",t)},expression:"reqData.PlatformList"}},[a("el-option",{attrs:{label:"ios",value:"ios"}}),e._v(" "),a("el-option",{attrs:{label:"android",value:"android"}})],1)],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:24,xs:24}},[a("el-form-item",{attrs:{label:"区服",prop:"ZoneList"}},[a("div",{staticClass:"checkbox"},[a("el-scrollbar",{staticStyle:{height:"100%"}},[a("el-checkbox",{attrs:{indeterminate:e.isSeverIdte},on:{change:e.serverChange},model:{value:e.serverCheckAll,callback:function(t){e.serverCheckAll=t},expression:"serverCheckAll"}},[e._v("全选")]),e._v(" "),a("el-checkbox-group",{model:{value:e.reqData.ZoneList,callback:function(t){e.$set(e.reqData,"ZoneList",t)},expression:"reqData.ZoneList"}},e._l(e.serveList,function(e,t){return a("el-checkbox",{key:t,attrs:{label:e,value:e}})}),1)],1)],1)])],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:24,xs:24}},[a("el-form-item",{attrs:{label:"国家",prop:"CountryList"}},[a("div",{staticClass:"checkbox"},[a("el-scrollbar",{staticStyle:{height:"100%"}},[a("el-checkbox",{attrs:{indeterminate:e.isCountryIdte},on:{change:e.countryChange},model:{value:e.countryCheckAll,callback:function(t){e.countryCheckAll=t},expression:"countryCheckAll"}},[e._v("全选")]),e._v(" "),a("el-checkbox-group",{model:{value:e.reqData.CountryList,callback:function(t){e.$set(e.reqData,"CountryList",t)},expression:"reqData.CountryList"}},e._l(e.allLang,function(t,r){return a("el-checkbox",{key:r,attrs:{label:t}},[e._v(e._s(t)+"\n                                ")])}),1)],1)],1)])],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:24,xs:24}},[a("el-form-item",{attrs:{label:"LTV",prop:"LtvList"}},[a("div",{staticClass:"checkbox"},[a("el-scrollbar",{staticStyle:{height:"100%"}},[a("el-checkbox",{attrs:{indeterminate:e.isLTVIdte},on:{change:e.ltvChange},model:{value:e.ltvCheckAll,callback:function(t){e.ltvCheckAll=t},expression:"ltvCheckAll"}},[e._v("全选\n                            ")]),e._v(" "),a("el-checkbox-group",{model:{value:e.reqData.LtvList,callback:function(t){e.$set(e.reqData,"LtvList",t)},expression:"reqData.LtvList"}},e._l(e.remainList,function(t,r){return a("el-checkbox",{key:r,attrs:{label:t}},[e._v(e._s(t)+"\n                                ")])}),1)],1)],1)])],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:24,xs:24}},[a("el-form-item",{attrs:{label:"留存",prop:"KeepDayList"}},[a("div",{staticClass:"checkbox"},[a("el-scrollbar",{staticStyle:{height:"100%"}},[a("el-checkbox",{attrs:{indeterminate:e.isRemainIdte},on:{change:e.remainChange},model:{value:e.remainCheckAll,callback:function(t){e.remainCheckAll=t},expression:"remainCheckAll"}},[e._v("全选")]),e._v(" "),a("el-checkbox-group",{model:{value:e.reqData.KeepDayList,callback:function(t){e.$set(e.reqData,"KeepDayList",t)},expression:"reqData.KeepDayList"}},e._l(e.remainList,function(t,r){return a("el-checkbox",{key:r,attrs:{label:t}},[e._v(e._s(t)+"\n                                ")])}),1)],1)],1)])],1)],1)],1),e._v(" "),a("div",{staticClass:"operate_btn"},[a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.search}},[e._v("search")]),e._v(" "),a("el-button",{attrs:{type:"plain",icon:"el-icon-refresh"},on:{click:function(t){return e.resetForm("reqData")}}},[e._v("reset")])],1),e._v(" "),a("div",{staticClass:"download_btn"},[a("el-button",{attrs:{type:"success",icon:"el-icon-download",plain:"",disabled:e.tableData.length<=0},on:{click:e.download}},[e._v("\n            download")])],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"","max-height":"600"}},e._l(e.tableHeads,function(t,r){return a("el-table-column",{key:r,attrs:{label:t,prop:e.tableProps[r]}})}),1)],1)},staticRenderFns:[]},L={name:"Operation",components:{Income:h,Online:a("VU/8")(b,f,!1,null,null,null).exports},data:function(){return{show_data:"1"}},methods:{}},y={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"common_content opt_content"},[a("el-tabs",{staticClass:"opt_tab",attrs:{type:"border-card"},model:{value:e.show_data,callback:function(t){e.show_data=t},expression:"show_data"}},[a("el-tab-pane",{attrs:{label:"在线数据",name:"1"}}),e._v(" "),a("el-tab-pane",{attrs:{label:"营收报表",name:"2"}})],1),e._v(" "),"1"==e.show_data?a("Online"):a("Income")],1)},staticRenderFns:[]};var C=a("VU/8")(L,y,!1,function(e){a("ZLrf")},"data-v-70c0bd17",null);t.default=C.exports},ZLrf:function(e,t){}});
//# sourceMappingURL=5.6d8f23751c40986f51f6.js.map